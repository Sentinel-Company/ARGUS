<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARGUS | PROJECT PROMETHEUS - Big Data Interface</title>
    <style>
        body { margin: 0; background-color: #000; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #00FFCC;
            z-index: 100;
            pointer-events: none;
            text-shadow: 0 0 10px rgba(0, 255, 204, 0.5);
        }
        .stats { font-size: 12px; color: #888; margin-top: 5px; }
        #loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #00FFCC;
            z-index: 1000;
            transition: opacity 1s ease;
        }
        .spinner {
            border: 4px solid rgba(0, 255, 204, 0.1);
            border-left-color: #00FFCC;
            width: 40px; height: 40px;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
    <script src="https://unpkg.com/3d-force-graph"></script>
</head>
<body>

    <div id="loading-screen">
        <div class="spinner"></div>
        <p>174MB DATA ARCHIVE LOADING...</p>
        <span style="font-size: 10px; color: #555;">ARGUS Core Engine v2.0</span>
    </div>

    <div id="ui-layer">
        <h2 style="margin:0; letter-spacing: 2px;">PROJECT PROMETHEUS</h2>
        <div class="stats" id="node-info">SCANNING BIG DATA NODES...</div>
        <div class="stats">OPTIMIZATION: ACTIVE (Low-Poly Mode)</div>
    </div>

    <div id="3d-graph"></div>

    <script>
        const elem = document.getElementById('3d-graph');
        
        const Graph = ForceGraph3D()(elem)
            .jsonUrl('./data_optimized.json') // Artık optimize edilmiş küçük dosyayı okuyacak
            .nodeAutoColorBy('group')
            .nodeLabel(node => `[SOURCE: ${node.group}] ${node.name}`)
            // --- KRİTİK PERFORMANS AYARLARI ---
            .nodeResolution(6)          // Kürelerin detayını düşür (3000+ kişi için şart)
            .linkWidth(0.2)             // Çizgileri incelt
            .linkOpacity(0.2)           // Çizgi saydamlığını düşür (GPU dostu)
            .linkResolution(1)          // Çizgi detayını minimize et
            .linkDirectionalParticles(1) // Parçacık sayısını 1'e indir
            .linkDirectionalParticleWidth(1)
            
            // --- MOTOR OPTİMİZASYONU ---
            .warmupTicks(50)           // Açılışta fiziksel hesaplamayı önceden yap
            .cooldownTicks(20)          // Gereksiz hareket hesaplamasını erken kes
            
            .backgroundColor('#000000')
            .onEngineStop(() => {
                document.getElementById('loading-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('loading-screen').remove(), 1000);
            });

        // Veri yüklendiğinde istatistikleri güncelle
        Graph.onDataLoad(data => {
            document.getElementById('node-info').innerText = `IDENTIFIED: ${data.nodes.length} ENTITIES | LINKS: ${data.links.length}`;
        });

        // Etkileşim: Tıklanan düğüme yumuşak geçişle odaklan
        Graph.onNodeClick(node => {
            const distance = 100;
            const distRatio = 1 + distance/Math.hypot(node.x, node.y, node.z);
            Graph.cameraPosition(
                { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }, 
                node, 
                2000
            );
        });
    </script>
</body>
</html>